FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHJlZHNoaWZ0LXNhbXBsZS1hcHAtYXBiCmRlc2NyaXB0aW9uOiBk\
ZXBsb3lzIGEgc2FtcGxlIHdlYiBhcHBsaWNhdGlvbgpiaW5kYWJsZTogZmFsc2UKYXN5bmM6IG9w\
dGlvbmFsCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAiQW1hem9uIFJlZFNoaWZ0IFNhbXBsZSBB\
cHBsaWNhdGlvbiAoQVBCKSIKICBsb25nRGVzY3JpcHRpb246IEEgc2FtcGxlIEFQQiB3aGljaCBk\
ZXBsb3lzIGEgY29udGFpbmVyaXplZCBzYW1wbGUgd2ViIGFwcGxpY2F0aW9uCiAgaW1hZ2VVcmw6\
ICJodHRwczovL3MzLmFtYXpvbmF3cy5jb20vdGhwLWF3cy1pY29ucy1kZXYvcmVkc2hpZnRfc2Ft\
cGxlLnBuZyIKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiVGhlIEhlbGlvcyBQcm9qZWN0IgpwbGFu\
czoKICAtIG5hbWU6IHJlZHNoaWZ0LXNhbXBsZQogICAgZGVzY3JpcHRpb246IEEgc2FtcGxlIEFQ\
QiB3aGljaCBkZXBsb3lzIGEgUHl0aG9uIHdlYiBhcHBsaWNhdGlvbiB0byBleHBvc2UgYSBSRVNU\
ZnVsIGFwaSB0byBhbiBBV1MgQVBCCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAg\
ZGlzcGxheU5hbWU6IFJlZFNoaWZ0IFJFU1QgU2FtcGxlCiAgICAgIGxvbmdEZXNjcmlwdGlvbjog\
VGhpcyBwbGFuIGRlcGxveXMgYSBQeXRob24gd2ViIGFwcGxpY2F0aW9uIHRvIGV4cG9zZSBhIFJF\
U1RmdWwgYXBpIHRvIGFuIEFXUyBBUEIKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6\
IFtdCg=="

ADD playbooks /opt/apb/actions
ADD roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
