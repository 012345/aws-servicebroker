FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGVtci1zYW1wbGUtYXBwLWFwYgpkZXNjcmlwdGlvbjogZGVwbG95\
cyBhIHNhbXBsZSB3ZWIgYXBwbGljYXRpb24KYmluZGFibGU6IGZhbHNlCmFzeW5jOiBvcHRpb25h\
bAptZXRhZGF0YToKICBkaXNwbGF5TmFtZTogIkFtYXpvbiBFTVIgU2FtcGxlIEFwcGxpY2F0aW9u\
IChBUEIpIgogIGxvbmdEZXNjcmlwdGlvbjogQSBzYW1wbGUgQVBCIHdoaWNoIGRlcGxveXMgYSBj\
b250YWluZXJpemVkIHNhbXBsZSB3ZWIgYXBwbGljYXRpb24KICBpbWFnZVVybDogImh0dHBzOi8v\
czMuYW1hem9uYXdzLmNvbS90aHAtYXdzLWljb25zLWRldi9lbXJfc2FtcGxlLnBuZyIKICBwcm92\
aWRlckRpc3BsYXlOYW1lOiAiVGhlIEhlbGlvcyBQcm9qZWN0IgpwbGFuczoKICAtIG5hbWU6IGVt\
ci1zYW1wbGUKICAgIGRlc2NyaXB0aW9uOiBBIHNhbXBsZSBBUEIgd2hpY2ggZGVwbG95cyBhIFB5\
dGhvbiB3ZWIgYXBwbGljYXRpb24gdG8gZXhwb3NlIGEgUkVTVGZ1bCBhcGkgdG8gYW4gQVdTIEFQ\
QgogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRhdGE6CiAgICAgIGRpc3BsYXlOYW1lOiBFTVIgUkVT\
VCBTYW1wbGUKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlzIHBsYW4gZGVwbG95cyBhIFB5dGhv\
biB3ZWIgYXBwbGljYXRpb24gdG8gZXhwb3NlIGEgUkVTVGZ1bCBhcGkgdG8gYW4gQVdTIEFQQgog\
ICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczogW10="

ADD playbooks /opt/apb/actions
ADD roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
