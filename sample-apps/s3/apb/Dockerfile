FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHMzLXNhbXBsZS1hcHAtYXBiCmRlc2NyaXB0aW9uOiBkZXBsb3lz\
IGEgc2FtcGxlIHdlYiBhcHBsaWNhdGlvbgpiaW5kYWJsZTogZmFsc2UKYXN5bmM6IG9wdGlvbmFs\
Cm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAiQW1hem9uIFMzIFNhbXBsZSBBcHBsaWNhdGlvbiAo\
QVBCKSIKICBsb25nRGVzY3JpcHRpb246IEEgc2FtcGxlIEFQQiB3aGljaCBkZXBsb3lzIGEgY29u\
dGFpbmVyaXplZCBzYW1wbGUgd2ViIGFwcGxpY2F0aW9uCiAgaW1hZ2VVcmw6ICJodHRwczovL3Mz\
LmFtYXpvbmF3cy5jb20vdGhwLWF3cy1pY29ucy1kZXYvczNfc2FtcGxlLnBuZyIKICBwcm92aWRl\
ckRpc3BsYXlOYW1lOiAiVGhlIEhlbGlvcyBQcm9qZWN0IgpwbGFuczoKICAtIG5hbWU6IHMzLXNh\
bXBsZQogICAgZGVzY3JpcHRpb246IEEgc2FtcGxlIEFQQiB3aGljaCBkZXBsb3lzIGEgUHl0aG9u\
IHdlYiBhcHBsaWNhdGlvbiB0byBleHBvc2UgYSBSRVNUZnVsIGFwaSB0byBhbiBBV1MgQVBCCiAg\
ICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IFMzIFJFU1QgU2Ft\
cGxlCiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIGRlcGxveXMgYSBQeXRob24gd2Vi\
IGFwcGxpY2F0aW9uIHRvIGV4cG9zZSBhIFJFU1RmdWwgYXBpIHRvIGFuIEFXUyBBUEIKICAgICAg\
Y29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6IFtd"


ADD playbooks /opt/apb/actions
ADD roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
